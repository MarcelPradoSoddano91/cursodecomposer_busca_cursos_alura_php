# Buscador de Cursos (Alura) ‚Äì PHP + Composer

Pequeno projeto did√°tico que usa **Composer**, **Guzzle** e **Symfony DomCrawler** para buscar os nomes dos cursos de PHP no site da **Alura** e exibir no terminal.

---

## ‚úÖ O que o projeto faz

- Faz uma requisi√ß√£o HTTP para uma p√°gina da Alura (base: `https://www.alura.com.br/`).
- Carrega o HTML com o **DomCrawler** e filtra os elementos de cursos (seletor `span.card-curso__nome`).
- Retorna uma **lista de strings** com os nomes dos cursos.
- Mostra os nomes no terminal.

---

## üß± Stack e depend√™ncias principais

- **PHP** (8.2+ recomendado ‚Äì exigido pelo `symfony/dom-crawler:^7`)
- **Composer**
- **guzzlehttp/guzzle:^7.10**
- **symfony/dom-crawler:^7.3** e **symfony/css-selector:^7.3**
- **phpunit/phpunit:^12.3** (tests)
- **squizlabs/php_codesniffer:^4.0** (PSR-12)
- **phan/phan:^5.5** (an√°lise est√°tica)

---

## üìÅ Estrutura do projeto

```
buscador_cursos_alura/
‚îú‚îÄ .phan/config.php              # Configura√ß√£o do Phan (inclui vendor para indexa√ß√£o)
‚îú‚îÄ buscar-cursos.php             # Script CLI que executa o buscador e imprime os cursos
‚îú‚îÄ composer.json                 # Autoload PSR-4: Alura\BuscadorDeCursos\ => src/
‚îú‚îÄ functions.php                 # Fun√ß√£o exibeMensagem()
‚îú‚îÄ src/
‚îÇ  ‚îî‚îÄ Buscador.php               # Classe Buscador (Guzzle + DomCrawler)
‚îú‚îÄ tests/
‚îÇ  ‚îî‚îÄ TestBuscadorDeCursos.php   # Teste unit√°rio (mocks de Guzzle/Response/Stream)
‚îî‚îÄ vendor/                       # Depend√™ncias do Composer
```

**Namespace:** `Alura\BuscadorDeCursos` (mapeado para `src/` via PSR-4).

---

## ‚öôÔ∏è Requisitos

- PHP **8.2+** (necess√°rio para `symfony/dom-crawler:^7`)
- Composer

Verifique sua vers√£o:
```bash
php -v
composer -V
```

---

## üöÄ Instala√ß√£o

Na raiz do projeto:

```bash
composer install
```

> Se instalar o **Phan** e quiser melhor performance, instale a extens√£o `php-ast` ou use a flag `--allow-polyfill-parser` (ver se√ß√£o de *Qualidade de C√≥digo*).

---

## ‚ñ∂Ô∏è Uso

Execute o script principal:

```bash
php buscar-cursos.php
```

Isso vai:
1. Construir um `GuzzleHttp\Client` com `base_uri` = `https://www.alura.com.br/`.
2. Instanciar `Symfony\Component\DomCrawler\Crawler`.
3. Chamar `Alura\BuscadorDeCursos\Buscador::buscar('/cursos-online-programacao/php')`.
4. Imprimir cada curso encontrado.

> **Observa√ß√£o:** O seletor CSS `span.card-curso__nome` depende do HTML da Alura. Se a p√°gina mudar, pode ser necess√°rio ajustar o seletor.

---

## üß™ Testes

Voc√™ pode rodar os testes diretamente pelo Composer (script j√° incluso):

```bash
composer test
```

ou diretamente:
```bash
vendor/bin/phpunit tests/TestBuscadorDeCursos.php
```

O teste cria *mocks* de `ClientInterface`, `ResponseInterface` e `StreamInterface`, injeta HTML de exemplo e valida que o `Buscador` retorna 3 cursos.

---

## üßπ Qualidade de c√≥digo

### Code Style (PSR-12)

```bash
composer cs
# ou diretamente:
vendor/bin/phpcs --standard=PSR12 src/
```

### An√°lise Est√°tica (Phan)

```bash
composer phan
# ou diretamente:
vendor/bin/phan --allow-polyfill-parser
```

O arquivo **.phan/config.php** j√° inclui `src` e algumas libs do `vendor` na `directory_list` para indexa√ß√£o de tipos.  
Se preferir performance m√°xima com Phan:
```bash
pecl install ast
# no php.ini:
# extension=ast.so
```

H√° tamb√©m um atalho para rodar tudo:
```bash
composer check   # roda @test, @cs e @phan
```

---

## üîß Como funciona internamente

### `src/Buscador.php`
- Recebe `ClientInterface` (Guzzle) e `Crawler` por inje√ß√£o de depend√™ncia.
- M√©todo `buscar(string $url): array`:
    1. `request('GET', $url)`
    2. `addHtmlContent($html)`
    3. `filter('span.card-curso__nome')`
    4. Extrai `textContent` e retorna um `array` de strings.

### `buscar-cursos.php`
- Monta `Client` e `Crawler`, instancia `Buscador` e imprime os cursos via `exibeMensagem()`.

---
